(()=>{"use strict";const t=document.getElementById("game"),e=document.getElementById("fifteen"),n=Array.from(e.querySelectorAll(".item"));if(16!==n.length)throw new Error("Должно быть ровно 16 items in HTML");n[15].style.display="none";let r=function(t){const e=[[],[],[],[]];let n=0,r=0;for(let l=0;l<t.length;l++)4<=r&&(n++,r=0),e[n][r]=t[l],r++;return e}(n.map((t=>Number(t.dataset.matrixId))));s(r);const l="gameShuffle";document.getElementById("shuffle").addEventListener("click",(()=>{let e,n=0;clearInterval(e),t.classList.add(l),e=setInterval((()=>{(function(t){var e=c(o,t),n=function(t,e){var n=c(o,t);const r=[];for(let l=0;l<t.length;l++)for(let a=0;a<t[l].length;a++)f(n,{x:a,y:l})&&(e&&e.x===a&&e.y===l||r.push({x:a,y:l}));return r}(t,a);u(e,n[Math.floor(Math.random()*n.length)],t),a=e})(r),s(r),n+=1,n>=50&&(n=0,clearInterval(e),t.classList.remove(l))}),70)}));let a=null;const o=16;function s(t){for(let r=0;r<t.length;r++)for(let l=0;l<t[r].length;l++){var e=t[r][l];i(n[e-1],l,r)}}function i(t,e,n){t.style.transform=`translate3D(${100*e}%, ${100*n}%, 0)`}function c(t,e){for(let n=0;n<e.length;n++)for(let r=0;r<e[n].length;r++)if(e[n][r]===t)return{x:r,y:n};return null}function f(t,e){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return!(1!==n&&1!==r||t.x!==e.x&&t.y!==e.y)}function u(t,n,r){var l=r[t.y][t.x];r[t.y][t.x]=r[n.y][n.x],r[n.y][n.x]=l,function(t){var e=t.flat();for(let t=0;t<y.length;t++)if(e[t]!==y[t])return!1;return!0}(r)&&setTimeout((()=>{e.classList.add(d),setTimeout((()=>{e.classList.remove(d)}),1e3)}),200)}e.addEventListener("click",(t=>{var e=t.target.closest("button");!e||f(t=c(Number(e.dataset.matrixId),r),e=c(o,r))&&(u(e,t,r),s(r))})),window.addEventListener("keydown",(t=>{if(t.key.includes("Arrow")){var e=c(o,r);const l={x:e.x,y:e.y};var n=t.key.split("Arrow")[1].toLowerCase();switch(t=r.length,n){case"up":l.y+=1;break;case"down":--l.y;break;case"left":l.x+=1;break;case"right":--l.x}l.y>=t||l.y<0||l.x>=t||l.x<0||(u(e,l,r),s(r))}}));const y=new Array(16).fill(0).map(((t,e)=>e+1)),d="fifteenWon"})();